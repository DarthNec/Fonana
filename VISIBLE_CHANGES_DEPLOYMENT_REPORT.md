# –û—Ç—á–µ—Ç –æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

## –î–∞—Ç–∞: 01.07.2025

### –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª –æ –¥–≤—É—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö –ø–æ—Å–ª–µ —Ä–µ–¥–∏–∑–∞–π–Ω–∞:
1. –ü—Ä–∏ –ø–æ–∫—É–ø–∫–µ –ø–æ—Å—Ç–æ–≤ —Ü–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–∞–∫ 0 –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä 0.05 SOL)
2. –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –∫—Ä–æ–ø –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "Canvas is empty")

### –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º

#### 1. –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–µ—Ä–µ–¥–∞—á–µ–π —Ü–µ–Ω—ã
- **–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ—Å–ª–µ —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã –ø–æ—Å—Ç–æ–≤, –¥–∞–Ω–Ω—ã–µ –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è –∏ —Ü–µ–Ω–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `post.access.price`
- **–ú–µ—Å—Ç–æ –æ—à–∏–±–∫–∏**: –í `app/feed/page.tsx` –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–µ–π—Å—Ç–≤–∏—è 'purchase' –ø–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è –≤–µ—Å—å –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç –ø–æ—Å—Ç–∞
- **–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è PurchaseModal —Å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º —Ü–µ–Ω—ã –∏–∑ `post.access.price`

#### 2. –ü—Ä–æ–±–ª–µ–º–∞ —Å –∫—Ä–æ–ø–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≥—Ä—É–∑–∫–æ–π –±–æ–ª—å—à–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ base64 —Ñ–æ—Ä–º–∞—Ç–µ
- **–†–µ—à–µ–Ω–∏–µ**: 
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
  - –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –º–æ–¥–∞–ª–∫–∏ –∫—Ä–æ–ø–∞
  - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

### –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

#### 1. app/feed/page.tsx
```typescript
case 'purchase':
  // –°–æ–∑–¥–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è PurchaseModal
  const purchasePost = {
    id: post.id,
    title: post.content.title,
    price: post.access?.price || 0, // –ë–µ—Ä–µ–º —Ü–µ–Ω—É –∏–∑ access
    currency: post.access?.currency || 'SOL',
    creator: {
      id: post.creator.id,
      name: post.creator.name,
      username: post.creator.username,
      avatar: post.creator.avatar,
      isVerified: post.creator.isVerified
    },
    flashSale: post.commerce?.flashSale ? {...} : undefined
  }
  setSelectedPost(purchasePost)
  setShowPurchaseModal(true)
  break
```

#### 2. components/CreatePostModal.tsx
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ base64 —Å—Ç—Ä–æ–∫–∏
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ 100ms –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –∫—Ä–æ–ø–∞ –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è state
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (>5MB)

#### 3. components/ImageCropModal.tsx
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (data:image/, blob:, http)
- –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –≤—ã–≤–æ–¥–æ–º —Ä–∞–∑–º–µ—Ä–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –î–æ–±–∞–≤–ª–µ–Ω—ã toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –∑–∞–≥—Ä—É–∑–∫–∏

### –°—Ç–∞—Ç—É—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

#### ‚úÖ –£—Å–ø–µ—à–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–≤–µ—Ä—Å–∏—è 20250701-102843-a301a11)
1. –°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ `/version-check` —Å —è—Ä–∫–∏–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–º —Ñ–æ–Ω–æ–º
2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫—Ä–∞—Å–Ω–∞—è –ø—É–ª—å—Å–∏—Ä—É—é—â–∞—è –∫–Ω–æ–ø–∫–∞ "VERSION üî•" –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏—é
3. –î–æ–±–∞–≤–ª–µ–Ω –±–∞–Ω–Ω–µ—Ä –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ Feed
4. –ò–∑–º–µ–Ω–µ–Ω —Ñ—É—Ç–µ—Ä –Ω–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
5. Service Worker –æ–±–Ω–æ–≤–ª–µ–Ω –¥–æ –≤–µ—Ä—Å–∏–∏ v8

#### ‚è≥ –û–∂–∏–¥–∞—é—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞—á–∏ —Ü–µ–Ω—ã –≤ PurchaseModal
2. –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ CreatePostModal
3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤ ImageCropModal

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

1. –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–æ–π:
```bash
./deploy-to-production.sh
```

2. –ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
- –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–ª–∞—Ç–Ω–æ–≥–æ –ø–æ—Å—Ç–∞ –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Ü–µ–Ω—É
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ–ª–∂–Ω–∞ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –∫—Ä–æ–ø –±–µ–∑ –æ—à–∏–±–æ–∫
- –í –∫–æ–Ω—Å–æ–ª–∏ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

3. –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å –∫—Ä–æ–ø–æ–º —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:
```bash
ssh -p 43988 root@69.10.59.234 "pm2 logs fonana --lines 100 --nostream > /tmp/logs.txt && cat /tmp/logs.txt | grep -E 'CreatePostModal|ImageCropModal'"
```

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. –ü—Ä–æ–±–ª–µ–º–∞ —Å –∫—Ä–æ–ø–æ–º –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–∞ —Å:
   - –°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
   - –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º —Ñ–∞–π–ª–∞
   - –ü—Ä–æ–±–ª–µ–º–∞–º–∏ —Å CORS –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
   
2. –î–æ–±–∞–≤–ª–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–º–æ–∂–µ—Ç —Ç–æ—á–Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∏—á–∏–Ω—É

3. –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–æ–ª—å—à–µ 5MB, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª–∏

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
2. –ü–æ–ø—Ä–æ—Å–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:
   - –ü–æ–∫—É–ø–∫—É –ø–ª–∞—Ç–Ω–æ–≥–æ –ø–æ—Å—Ç–∞ (–¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ü–µ–Ω–∞)
   - –ó–∞–≥—Ä—É–∑–∫—É —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–º–∞–ª–µ–Ω—å–∫–∏—Ö –∏ –±–æ–ª—å—à–∏—Ö)
3. –°–æ–±—Ä–∞—Ç—å –ª–æ–≥–∏ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ 