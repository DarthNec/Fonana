# Дашборд аналитики для создателей

## Обзор
Реализован расширенный дашборд аналитики для создателей контента с графиками доходов, статистикой просмотров, топ постами/подписчиками и функцией вывода средств.

## Новые функции

### 1. График доходов (RevenueChart)
- **Периоды**: День, неделя, месяц
- **Визуализация**: Линейный график доходов по времени
- **Статистика**: 
  - Текущий доход vs предыдущий период
  - Процент роста
  - Доходы по типам (подписки, посты, чаевые, сообщения)

### 2. Топ посты и подписчики
- **Топ 5 постов** по доходам
- **Топ 10 подписчиков** по потраченной сумме
- Детальная информация о покупках и транзакциях

### 3. Статистика просмотров
- Общее количество просмотров
- Средние просмотры на пост
- Коэффициент вовлеченности (лайки + комментарии / просмотры)

### 4. Кнопка вывода средств (WithdrawButton)
- Минимальная сумма: 0.1 SOL
- Проверка доступного баланса
- Время обработки: до 24 часов
- Автоматическое уведомление о запросе

### 5. Экспорт данных в CSV
- Экспорт всей аналитики за выбранный период
- Включает:
  - Доходы по периодам (SOL и USD)
  - Доходы по типам
  - Топ посты с доходами
  - Топ подписчики с суммами

## API эндпоинты

### GET /api/creators/analytics
Получение расширенной аналитики создателя.

**Параметры:**
- `creatorId` - ID создателя
- `period` - Период (day/week/month)

**Ответ:**
```json
{
  "period": "week",
  "revenue": {
    "current": 12.5,
    "previous": 10.2,
    "growth": 22.5,
    "byPeriod": { "2025-01": 5.2, "2025-02": 7.3 },
    "byType": {
      "subscriptions": 8.0,
      "posts": 3.5,
      "tips": 1.0,
      "messages": 0.0
    }
  },
  "topPosts": [...],
  "topSubscribers": [...],
  "engagement": {
    "totalViews": 15420,
    "totalLikes": 823,
    "totalComments": 142,
    "averageViews": 257,
    "engagementRate": 6.3
  },
  "subscribers": {
    "total": 156,
    "new": 23,
    "growthRate": 14.7
  }
}
```

### POST /api/withdrawals
Создание запроса на вывод средств.

**Тело запроса:**
```json
{
  "userId": "user_id",
  "amount": 1.5,
  "toWallet": "wallet_address"
}
```

### GET /api/withdrawals
Получение истории выводов.

**Параметры:**
- `userId` - ID пользователя

## Интеграция в дашборд

### Обновленная страница /dashboard
- Добавлен компонент `RevenueChart` с полной аналитикой
- Кнопка вывода средств в шапке при наличии баланса
- Обновлена статистика в карточках (использует реальные данные)
- Все тексты переведены на русский язык

### Зависимости
- `chart.js` - библиотека графиков
- `react-chartjs-2` - React обертка для Chart.js
- `date-fns` - работа с датами

## Безопасность
- Проверка доступного баланса перед выводом
- Валидация минимальной суммы вывода
- Логирование всех транзакций
- Уведомления пользователям о статусе

## Производительность
- Кеширование данных аналитики
- Оптимизированные запросы к БД
- Ленивая загрузка графиков

## Будущие улучшения
- Добавить фильтры по категориям контента
- Расширить периоды (квартал, год)
- Добавить сравнение с другими создателями
- Реализовать автоматический вывод средств
- Добавить прогнозирование доходов 