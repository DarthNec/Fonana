# üõ†Ô∏è –ü–õ–ê–ù –†–ï–®–ï–ù–ò–Ø - CREATE POST 405 ERROR

**ID –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏**: [create_post_405_2025_017]  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 17.07.2025, 17:40 UTC  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô

## üéØ –ó–ê–î–ê–ß–ê
–ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫—É 405 Method Not Allowed –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ API `/api/posts` –∏ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ —Å—Ö–µ–º—ã Prisma.

## üîç –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú–´

### –û–°–ù–û–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê
1. **API `/api/posts` –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç POST –º–µ—Ç–æ–¥** - —Ç–æ–ª—å–∫–æ GET —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
2. **getUserByWallet —Ñ—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è** - `solanaWallet` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ë–î
3. **Frontend –≥–æ—Ç–æ–≤ –∫ —Å–æ–∑–¥–∞–Ω–∏—é –ø–æ—Å—Ç–æ–≤**, –Ω–æ backend –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–µ—Å—å –ø–æ—Ç–æ–∫

### –û–ë–ù–ê–†–£–ñ–ï–ù–ù–´–ï –û–®–ò–ë–ö–ò PRISMA
```
Unknown argument `solanaWallet`. Available options are marked with ?.
Unknown argument `paymentStatus`. Available options are marked with ?.  
Unknown field `referrer` for include statement on model `User`. Available options are marked with ?.
```

## üìã –ü–õ–ê–ù –†–ï–®–ï–ù–ò–Ø

### –§–ê–ó–ê 1: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï API POSTS [30 –º–∏–Ω]
**–¶–µ–ª—å**: –î–æ–±–∞–≤–∏—Ç—å POST –º–µ—Ç–æ–¥ –≤ `/api/posts/route.ts`

#### –ó–∞–¥–∞—á–∏:
1. **–°–æ–∑–¥–∞—Ç—å POST —Ñ—É–Ω–∫—Ü–∏—é** –≤ app/api/posts/route.ts
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–ø—Ä–æ—â–µ–Ω–Ω—É—é —Å—Ö–µ–º—É** –±–µ–∑ —Å–ª–æ–∂–Ω—ã—Ö —Å–≤—è–∑–µ–π  
3. **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** –ø–æ —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ë–î
4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤** (thumbnail, mediaUrl)
5. **–ê–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç postsCount** —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∏–∑ frontend):
```json
{
  "userWallet": "string",
  "title": "string", 
  "content": "string",
  "type": "image|text|video",
  "category": "string",
  "tags": "array",
  "thumbnail": "string",
  "mediaUrl": "string", 
  "isLocked": "boolean",
  "accessType": "free|paid",
  "imageAspectRatio": "string",
  "isSellable": "boolean"
}
```

#### –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
```json
{
  "success": true,
  "post": {
    "id": "string",
    "title": "string",
    "createdAt": "datetime",
    "creator": "object"
  }
}
```

### –§–ê–ó–ê 2: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –§–£–ù–ö–¶–ò–ò getUserByWallet [15 –º–∏–Ω]
**–¶–µ–ª—å**: –£—Å—Ç—Ä–∞–Ω–∏—Ç—å –æ—à–∏–±–∫–∏ Prisma –≤ lib/db.ts

#### –ó–∞–¥–∞—á–∏:
1. **–£–±—Ä–∞—Ç—å –ø–æ–ª–µ `solanaWallet`** –∏–∑ –ø–æ–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ `wallet`** –ø–æ–ª–µ –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –ø–æ—Å—Ç–∞

### –§–ê–ó–ê 3: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –°–í–Ø–ó–ê–ù–ù–´–• API [20 –º–∏–Ω]  
**–¶–µ–ª—å**: –£—Å—Ç—Ä–∞–Ω–∏—Ç—å –≤—Å–µ Prisma –æ—à–∏–±–∫–∏ –≤ –¥—Ä—É–≥–∏—Ö endpoints

#### –ó–∞–¥–∞—á–∏:
1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å `/api/user/route.ts`** - —É–±—Ä–∞—Ç—å `referrer` include
2. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å `/api/subscriptions/check/route.ts`** - —É–±—Ä–∞—Ç—å `paymentStatus` —Ñ–∏–ª—å—Ç—Ä
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ API endpoints** –Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ö–µ–º–æ–π –ë–î

### –§–ê–ó–ê 4: –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ò –í–ê–õ–ò–î–ê–¶–ò–Ø [15 –º–∏–Ω]
**–¶–µ–ª—å**: –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç end-to-end

#### –ó–∞–¥–∞—á–∏:
1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ curl** - POST –∑–∞–ø—Ä–æ—Å –∫ `/api/posts`
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ frontend** - –º–æ–¥–∞–ª–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ë–î** - –Ω–æ–≤—ã–π –ø–æ—Å—Ç –ø–æ—è–≤–ª—è–µ—Ç—Å—è
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—á–µ—Ç—á–∏–∫–æ–≤** - postsCount —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è
5. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è** - –ø–æ—Å—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ feed/creators

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò

### POST /api/posts –°–¢–†–£–ö–¢–£–†–ê
```typescript
export async function POST(request: NextRequest) {
  try {
    // 1. –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    // 2. –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ wallet (—Ç–æ–ª—å–∫–æ wallet –ø–æ–ª–µ)
    // 3. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ –≤ –ë–î
    // 4. –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç postsCount
    // 5. –í–æ–∑–≤—Ä–∞—Ç —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø–æ—Å—Ç–∞
  } catch (error) {
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
  }
}
```

### –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –ü–û–õ–Ø –î–õ–Ø –°–û–ó–î–ê–ù–ò–Ø –ü–û–°–¢–ê
- `userWallet` (string) - –∫–æ—à–µ–ª–µ–∫ —Å–æ–∑–¥–∞—Ç–µ–ª—è
- `type` (string) - —Ç–∏–ø –ø–æ—Å—Ç–∞: "text", "image", "video"
- –î–ª—è type !== "text": `mediaUrl` –ò–õ–ò `thumbnail`

### –û–ü–¶–ò–û–ù–ê–õ–¨–ù–´–ï –ü–û–õ–Ø
- `title`, `content`, `category`, `tags[]`
- `isLocked`, `isPremium`, `price`, `currency`
- `imageAspectRatio`, `isSellable`

## üéØ –ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê

### ‚úÖ –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –ö–†–ò–¢–ï–†–ò–ò
1. **POST /api/posts –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 201 Created**
2. **–ù–µ—Ç Prisma –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö**
3. **–ü–æ—Å—Ç –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –ë–î** —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
4. **postsCount —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è** —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
5. **–ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã**

### ‚úÖ UX –ö–†–ò–¢–ï–†–ò–ò  
1. **–ú–æ–¥–∞–ª–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç** –±–µ–∑ –æ—à–∏–±–æ–∫
2. **–°–æ–∑–¥–∞–Ω–Ω—ã–π –ø–æ—Å—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è** –≤ feed
3. **–°—á–µ—Ç—á–∏–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è** –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö –∫—Ä–µ–∞—Ç–æ—Ä–æ–≤
4. **–í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è < 3 —Å–µ–∫—É–Ω–¥**

## ‚ö†Ô∏è –†–ò–°–ö–ò –ò –ú–ò–¢–ò–ì–ê–¶–ò–Ø

### –†–ò–°–ö 1: –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –º–µ–¥–∏–∞ —Ñ–∞–π–ª–∞–º–∏
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏ –∏–∑ `/media/posts/`

### –†–ò–°–ö 2: –ù–∞—Ä—É—à–µ–Ω–∏–µ —Å–≤—è–∑–µ–π –≤ –ë–î
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø–æ–ª—è –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ö–µ–º—ã

### –†–ò–°–ö 3: –†–µ–≥—Ä–µ—Å—Å–∏—è –≤ –¥—Ä—É–≥–∏—Ö API
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å /api/creators –∏ /api/posts GET –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üìä –í–†–ï–ú–ï–ô–ù
- **–§–∞–∑–∞ 1**: 30 –º–∏–Ω - –°–æ–∑–¥–∞–Ω–∏–µ POST API
- **–§–∞–∑–∞ 2**: 15 –º–∏–Ω - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ getUserByWallet  
- **–§–∞–∑–∞ 3**: 20 –º–∏–Ω - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö API
- **–§–∞–∑–∞ 4**: 15 –º–∏–Ω - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ò–¢–û–ì–û**: 80 –º–∏–Ω—É—Ç (1.33 —á–∞—Å–∞)

## üîÑ –û–¢–ö–ê–¢ –í –°–õ–£–ß–ê–ï –ü–†–û–ë–õ–ï–ú
1. **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å backup** —Ç–µ–∫—É—â–∏—Ö API —Ñ–∞–π–ª–æ–≤
2. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ—Ç–∫–∞—Ç–∞
3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≤–µ—Ç–∫–µ** –ø–µ—Ä–µ–¥ merge 