# –ü–æ–ª–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Ç–∏—Ä–æ–≤ –ø–æ–¥–ø–∏—Å–æ–∫

## –ü—Ä–æ–±–ª–µ–º–∞
1. –ü–æ—Å—Ç—ã —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ–º VIP/Premium —Ç–∏—Ä–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏—Å—å –∫–∞–∫ "Subscribers Only"
2. –ù–µ –±—ã–ª–æ –≤–∏–∑—É–∞–ª—å–Ω–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–∏ —Ç—Ä–µ–±—É–µ–º–æ–≥–æ —Ç–∏—Ä–∞
3. CreatePostModal –æ—Ç–ø—Ä–∞–≤–ª—è–ª –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–ª–µ –¥–ª—è —Ç–∏—Ä–æ–≤

## –†–µ—à–µ–Ω–∏–µ

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ PostCard (`components/PostCard.tsx`)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è `isTierContent`
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `getTierInfo` –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–∫–æ–Ω–∫–∏ —Ç–∏—Ä–æ–≤: ‚≠ê Basic, üíé Premium, üëë VIP
- –û–±–Ω–æ–≤–ª–µ–Ω UI –¥–ª—è –ø–æ–∫–∞–∑–∞:
  - "üëë VIP Content" –≤–º–µ—Å—Ç–æ "Subscribers Only"
  - "This content requires üëë VIP subscription"
  - –ö–Ω–æ–ø–∫–∞ "Subscribe to VIP" –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ "Subscribe"

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω CreatePostModal (`components/CreatePostModal.tsx`)
- –¢–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `minSubscriptionTier` –≤–º–µ—Å—Ç–æ `tier`
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –º–∞–ø–∏—Ç:
  - 'vip' ‚Üí 'vip'
  - 'premium' ‚Üí 'premium'
  - 'subscribers' ‚Üí 'basic'

### 3. –û–±–Ω–æ–≤–ª–µ–Ω API (`app/api/posts/route.ts`)
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç `minSubscriptionTier` –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞
- –ú–∞–ø–∏—Ç –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ `tier` –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ `createPost`
- –ü–µ—Ä–µ–¥–∞–µ—Ç `requiredTier` –∏ `userTier` –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥

### 4. Content Type Badge
- –û–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –ø–æ–∫–∞–∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤ –∏ –∏–∫–æ–Ω–æ–∫:
  - VIP: –∑–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç, –∏–∫–æ–Ω–∫–∞ üëë
  - Premium: —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π —Ü–≤–µ—Ç, –∏–∫–æ–Ω–∫–∞ üíé
  - Basic: —Å–∏–Ω–∏–π —Ü–≤–µ—Ç, –∏–∫–æ–Ω–∫–∞ ‚≠ê

## –†–µ–∑—É–ª—å—Ç–∞—Ç
–¢–µ–ø–µ—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç:
- –ü—Ä–∞–≤–∏–ª—å–Ω—É—é –∏–Ω–¥–∏–∫–∞—Ü–∏—é —Ç—Ä–µ–±—É–µ–º–æ–≥–æ —Ç–∏—Ä–∞
- –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–π –ø–æ–¥–ø–∏—Å–∫–µ
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –Ω—É–∂–Ω–æ–≥–æ —Ç–∏—Ä–∞

## –ü—Ä–∏–º–µ—Ä—ã:
- VIP –ø–æ—Å—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: "üëë VIP Content" —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º "This content requires üëë VIP subscription"
- Premium –ø–æ—Å—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: "üíé Premium Content" —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ Premium –ø–æ–¥–ø–∏—Å–∫–∏
- –ï—Å–ª–∏ –µ—Å—Ç—å Basic –ø–æ–¥–ø–∏—Å–∫–∞, –Ω–æ –Ω—É–∂–µ–Ω Premium: "You have ‚≠ê Basic subscription. Upgrade to üíé Premium to access this content."

–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–æ—Å—Ç—É–ø—É. 

# –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Ç–∏—Ä–∞–º–∏ –ø–æ–¥–ø–∏—Å–æ–∫

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Å–æ–∑–¥–∞—Ç–µ–ª—è –±–µ–∑ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ç–∏—Ä–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–ª–µ–¥—É—é—â–µ–µ:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç Premium –∏–ª–∏ VIP —Ç–∏—Ä
2. –û–ø–ª–∞—á–∏–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Å—É–º–º—É (0.15 –∏–ª–∏ 0.35 SOL)
3. –ù–æ –≤ –±–∞–∑—É —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è Basic —Ç–∏—Ä –∑–∞ 0.05 SOL

## –ü—Ä–∏—á–∏–Ω–∞

**–ö–õ–Æ–ß–ï–í–ê–Ø –ü–†–û–ë–õ–ï–ú–ê**: –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –ø–ª–∞–Ω–∞ –∏ —Ü–µ–Ω—ã –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø–æ–¥–ø–∏—Å–∫–∏!

–í `app/api/subscriptions/process-payment/route.ts` –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Ü–µ–Ω—ã, –Ω–æ –ø–æ–¥–ø–∏—Å–∫–∞ –≤—Å–µ —Ä–∞–≤–Ω–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º –ø–ª–∞–Ω–æ–º.

## –†–µ—à–µ–Ω–∏–µ

### 1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–ª–∞–Ω–∞ –∏ —Ü–µ–Ω—ã

```typescript
// app/api/subscriptions/process-payment/route.ts

// –ü–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 75, –∑–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞:
const tierPrices: Record<string, number> = {
  'basic': 0.05,
  'premium': 0.15,
  'vip': 0.35
}

// –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø–ª–∞–Ω –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
const normalizedPlan = plan.toLowerCase()

// –ï—Å–ª–∏ –Ω–µ—Ç Flash Sale, –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ü–µ–Ω—ã –ø–ª–∞–Ω—É
if (!flashSaleId && tierPrices[normalizedPlan]) {
  const expectedPrice = tierPrices[normalizedPlan]
  
  // –ï—Å–ª–∏ —Ü–µ–Ω–∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–ª–∞–Ω—É, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–ª–∞–Ω –ø–æ —Ü–µ–Ω–µ
  if (Math.abs(price - expectedPrice) > 0.001) {
    // –ù–∞—Ö–æ–¥–∏–º –ø–ª–∞–Ω, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –æ–ø–ª–∞—á–µ–Ω–Ω–æ–π —Ü–µ–Ω–µ
    const actualPlan = Object.entries(tierPrices).find(([_, p]) => 
      Math.abs(price - p) < 0.001
    )
    
    if (actualPlan) {
      // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–ª–∞–Ω, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –æ–ø–ª–∞—á–µ–Ω–Ω–æ–π —Ü–µ–Ω–µ
      plan = actualPlan[0].charAt(0).toUpperCase() + actualPlan[0].slice(1) // 'basic' -> 'Basic'
      
      paymentLogger.warn('Plan adjusted based on price', {
        requestedPlan: body.plan,
        adjustedPlan: plan,
        price
      })
    } else {
      // –ï—Å–ª–∏ —Ü–µ–Ω–∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∏ –æ–¥–Ω–æ–º—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –ø–ª–∞–Ω—É
      paymentLogger.error('Price does not match any standard tier', {
        price,
        requestedPlan: plan
      })
      
      return NextResponse.json(
        { error: 'Invalid subscription price for the selected plan' },
        { status: 400 }
      )
    }
  }
}
```

### 2. –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç –ø–ª–∞–Ω–æ–≤

–í—Å–µ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø–ª–∞–Ω—ã –≤ –µ–¥–∏–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ —Å –∑–∞–≥–ª–∞–≤–Ω–æ–π –±—É–∫–≤—ã:

```typescript
// –ü–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –ë–î –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø–ª–∞–Ω
const normalizedPlanName = plan.charAt(0).toUpperCase() + plan.slice(1).toLowerCase()
// 'BASIC' -> 'Basic', 'premium' -> 'Premium', 'VIP' -> 'Vip'
```

### 3. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ frontend

–í `app/creator/[id]/page.tsx` —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ toLowerCase() –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–π.

### 4. –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

–í SubscribeModal –¥–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

```typescript
console.log('[SubscribeModal] Subscription attempt:', {
  selectedTier: selectedTier,
  selectedPlan: selectedSubscription.name,
  price: selectedSubscription.price,
  finalPrice: finalPrice,
  creatorHasCustomTiers: !!tierSettings
})
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—à–µ–Ω–∏—è

–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
1. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª Premium (0.15 SOL) –Ω–æ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª—É—á–∏–ª–∞ Basic —Ü–µ–Ω—É (0.05 SOL), –ø–ª–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞ Basic
2. –ï—Å–ª–∏ —Ü–µ–Ω–∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∏ –æ–¥–Ω–æ–º—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É —Ç–∏—Ä—É - —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –±—É–¥–µ—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞
3. –í—Å–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø–ª–∞–Ω–æ–≤ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ frontend** –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
2. **–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ** –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º–æ–π —Å—É–º–º–µ
3. **–õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è** –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ 