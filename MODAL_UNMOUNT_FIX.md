# Исправление проблемы unmount модалки редактирования

## Дата: 26.12.2024

### Проблема:
Модалка редактирования падала (unmount) сразу после выбора нового файла изображения в feed, но работала нормально в test/post-management.

### Причина:
EditPostModal находилась внутри компонента PostCard. При обновлении списка постов в feed (например, при изменении состояния) PostCard мог перерендериваться или полностью пересоздаваться, что приводило к unmount модалки.

### Симптомы:
1. Модалка закрывалась сразу после выбора файла
2. Проблема проявлялась только в feed
3. В test/post-management всё работало корректно

### Решение:
Переместить EditPostModal на уровень Feed страницы, чтобы она не зависела от жизненного цикла PostCard.

### Изменения:

1. **components/PostCard.tsx**:
   - Добавлен prop `onEditClick` для callback
   - Локальная модалка рендерится только если нет callback
   - При клике на редактирование вызывается callback с данными поста

2. **app/feed/page.tsx**:
   - Добавлено состояние для модалки редактирования
   - Добавлен обработчик `handleEditClick`
   - EditPostModal рендерится на уровне страницы
   - PostCard получает callback `onEditClick`

3. **components/EditPostModal.tsx**:
   - Добавлено отслеживание mount/unmount для отладки
   - Улучшена обработка состояний
   - Добавлена защита от потери данных

### Результат:
- Модалка больше не закрывается при выборе файла
- Редактирование работает стабильно во всех сценариях
- Нет зависимости от перерендера списка постов

### Статус: ✅ Исправлено 