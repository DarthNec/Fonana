# Исправление кеширования аватара в навбаре - 19 июня 2025

## Проблема
При смене аватара пользователя он не обновлялся в навбаре из-за кеширования браузера.

## Причина
Браузер кеширует изображения по URL. Когда пользователь меняет аватар, URL остается тем же (`/avatars/avatar_xxx.jpg`), поэтому браузер продолжает показывать старое изображение из кеша.

## Решение
Добавлен timestamp к URL аватара в компоненте `Navbar.tsx`:

```typescript
// Добавляем timestamp к аватару для обхода кеширования
// Используем updatedAt пользователя для стабильного timestamp
const avatarUrl = user?.avatar 
  ? `${user.avatar}?t=${user.updatedAt ? new Date(user.updatedAt).getTime() : Date.now()}` 
  : undefined
```

Теперь при обновлении аватара URL будет выглядеть как `/avatars/avatar_xxx.jpg?t=1750358400000`, что заставит браузер загрузить новое изображение.

## Детали реализации
1. Используется поле `updatedAt` пользователя для генерации timestamp
2. Это обеспечивает стабильный URL до следующего обновления профиля
3. Если `updatedAt` недоступен, используется `Date.now()` как fallback

## Статус
✅ Проблема исправлена и развернута в production
✅ Аватар теперь обновляется в навбаре сразу после изменения

## Дополнительные заметки
В будущем может потребоваться применить аналогичное решение для:
- Аватаров в комментариях (`app/post/[id]/page.tsx`)
- Аватаров создателей в постах
- Других мест, где отображаются аватары пользователей 